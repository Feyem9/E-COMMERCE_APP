<div class="container py-5">
  <div class="row">
    <div class="col-12">
      <!-- Orders List View -->
      <div *ngIf="!showDetails">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2>My Orders</h2>
          <div class="text-end">
            <p class="text-muted mb-0">Total Orders: {{ orders.length }}</p>
          </div>
        </div>

        <!-- Loading state -->
        <div *ngIf="loading" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3">Loading your orders...</p>
        </div>

        <!-- Error state -->
        <div *ngIf="error" class="alert alert-danger">
          {{ error }}
        </div>

        <!-- Empty state -->
        <div *ngIf="!loading && orders.length === 0" class="text-center py-5">
          <i class="fas fa-box-open fa-4x text-muted mb-3"></i>
          <h4>No orders yet</h4>
          <p class="text-muted">You haven't placed any orders yet</p>
          <a routerLink="/product" class="btn btn-primary mt-3">
            <i class="fas fa-shopping-bag me-2"></i>Start Shopping
          </a>
        </div>

        <!-- Orders Table -->
        <div *ngIf="!loading && orders.length > 0" class="table-responsive">
          <table class="table table-hover">
            <thead class="table-light">
              <tr>
                <th>Order #</th>
                <th>Date</th>
                <th>Status</th>
                <th>Items</th>
                <th>Total</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let order of orders" (click)="viewOrderDetails(order)" style="cursor: pointer;">
                <td>{{ order.id }}</td>
                <td>{{ order.date }}</td>
                <td>
                  <span class="badge" [class]="getStatusBadgeClass(order.status)">
                    {{ order.status }}
                  </span>
                </td>
                <td>{{ order.items }}</td>
                <td>${{ order.total.toFixed(2) }}</td>
                <td>
                  <button class="btn btn-sm btn-outline-primary me-2" (click)="trackOrder(order.trackingNumber!); $event.stopPropagation()">
                    <i class="fas fa-truck"></i> Track
                  </button>
                  <button class="btn btn-sm btn-outline-success" (click)="reorder(order.id); $event.stopPropagation()">
                    <i class="fas fa-redo"></i> Reorder
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Order Details View -->
      <div *ngIf="showDetails && selectedOrder" class="order-details">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2>Order Details</h2>
          <button class="btn btn-outline-secondary" (click)="backToOrders()">
            <i class="fas fa-arrow-left me-2"></i>Back to Orders
          </button>
        </div>

        <div class="card mb-4">
          <div class="card-body">
            <div class="row">
              <div class="col-md-6">
                <h5 class="card-title">Order Information</h5>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item"><strong>Order ID:</strong> {{ selectedOrder.id }}</li>
                  <li class="list-group-item"><strong>Date:</strong> {{ selectedOrder.date }}</li>
                  <li class="list-group-item"><strong>Status:</strong>
                    <span class="badge" [class]="getStatusBadgeClass(selectedOrder.status)">
                      {{ selectedOrder.status }}
                    </span>
                  </li>
                  <li class="list-group-item" *ngIf="selectedOrder.trackingNumber">
                    <strong>Tracking #:</strong> {{ selectedOrder.trackingNumber }}
                  </li>
                </ul>
              </div>
              <div class="col-md-6">
                <h5 class="card-title">Order Summary</h5>
                <ul class="list-group list-group-flush">
                  <li class="list-group-item"><strong>Items:</strong> {{ selectedOrder.items }}</li>
                  <li class="list-group-item"><strong>Subtotal:</strong> ${{ (selectedOrder.total * 0.9).toFixed(2) }}</li>
                  <li class="list-group-item"><strong>Shipping:</strong> $99.99</li>
                  <li class="list-group-item"><strong>Total:</strong> ${{ selectedOrder.total.toFixed(2) }}</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <h4 class="mb-3">Order Items</h4>
        <div class="row g-3">
          <div class="col-md-6" *ngFor="let item of orderDetails">
            <div class="card">
              <div class="row g-0">
                <div class="col-md-4">
                  <img [src]="item.image" [alt]="item.name" class="img-fluid rounded-start" style="height: 120px; object-fit: contain; padding: 10px;">
                </div>
                <div class="col-md-8">
                  <div class="card-body">
                    <h5 class="card-title">{{ item.name }}</h5>
                    <p class="card-text">
                      <strong>Price:</strong> ${{ item.price.toFixed(2) }} |
                      <strong>Quantity:</strong> {{ item.quantity }} |
                      <strong>Total:</strong> ${{ (item.price * item.quantity).toFixed(2) }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-4 text-end">
          <button class="btn btn-primary me-2" (click)="trackOrder(selectedOrder.trackingNumber!)">
            <i class="fas fa-truck me-2"></i>Track Order
          </button>
          <button class="btn btn-success" (click)="reorder(selectedOrder.id)">
            <i class="fas fa-redo me-2"></i>Reorder
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
